## 接入指南

开发者需要按照如下步骤完成：

1、填写服务器配置

2、验证服务器地址的有效性

3、依据接口文档实现业务逻辑

下面详细介绍这3个步骤。

### 第一步：填写服务器配置
登录平台，在已创建的App中，选择“修改配置”按钮，填写服务器地址（URL）、client\_key和client\_secret，其中URL是开发者用来接收平台消息或事件的接口地址。client\_key是由开发者任意填写，用作生成签名（该client\_key会与接口URL中引入签名的client\_key进行比对，目的是检验该次调用是来自平台的，起到安全验证的作用）。client_secret由开发者手动填写或随机生成，用作消息体的对称加密和解密，加密和解密采用AES算法。
注意：开发者可选择消息体的加解密方式有三种：明文模式、兼容模式和安全模式。模式的选择与服务器配置在提交后都会立即生效，请开发者谨慎填写及选择。加解密方式的默认状态为明文模式，选择兼容模式和安全模式需要提前配置好相关加解密代码。

### 第二步：验证服务器地址的有效性
开发者的系统与平台对接，平台必须知道给开发者系统推送消息的地址，同时开发者的系统在接收平台发送的消息时，必须确认该消息是来自平台而非其他第三方或黑客，故验证服务器地址的有效性极为重要。

开发者在提交信息后，平台将发送HTTP GET请求到填写的服务器地址URL上。

`GET {URL}` URL为开发者填写的以http://或https://开头的字符串

#### 输入参数

`signature`  *必须* 加密签名

signature结合了开发者填写的client_key参数和请求中的timestamp参数、nonce参数。

`timestamp` *必须* 时间戳

`nonce`  *必须* 随机数

`echostr` *必须* 随机字符串

开发者通过检验signature对请求进行校验。

若确认此次GET请求来自平台，请原样返回echostr参数内容，则接入生效，成为开发者成功，否则接入失败。

加密/校验流程如下：

1）将client_key、timestamp、nonce三个参数进行字典序排序

2）将三个参数字符串拼接成一个字符串进行sha1签名，记做signature_sha1

3）将获得的签名字符串signature_sha1与输入参数signature比较，如果一致，则表明该请求来源于平台，接入成功；否则，该请求不是来自平台，接入失败。

### 第三步：依据接口文档实现业务逻辑
验证URL有效性成功后即接入生效。开发者可以为该应用申请更多接口权限，满足业务需求。

接口类型按业务处理需要分为两类：同步和异步。

同步接口，是指调用结果在请求的响应中返回，异步接口是指调用结果通过URL返回。

对于异步接口，开发者在调用时，接口立即返回，表示“平台已经接收到该请求，不用在此等候，平台会通过URL消息中返回业务结果”。开发者必须在配置的URL中处理平台推送过来的消息和事件，并可以依据自身业务逻辑给出响应。

